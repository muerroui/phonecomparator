
    <!-- Navigation -->
    <nav
      class="navbar navbar-expand-lg bg-secondary fixed-top text-uppercase"
      id="mainNav"
    >
      <div class="container">
        <a class="navbar-brand js-scroll-trigger" href="#page-top"
          ><img src="img/logo.png" width="210" height="75" alt="phone Comparator"
        /></a>
        <button
          class="navbar-toggler navbar-toggler-right text-uppercase bg-primary text-white rounded"
          type="button"
          data-toggle="collapse"
          data-target="#navbarResponsive"
          aria-controls="navbarResponsive"
          aria-expanded="false"
          aria-label="Toggle navigation"
        >
          Menu
          <i class="fas fa-bars"></i>
        </button>
        <div class="collapse navbar-collapse" id="navbarResponsive">
          <ul class="navbar-nav ml-auto">
            <li class="nav-item mx-0 mx-lg-1">
              <a
                class="nav-link py-3 px-0 px-lg-3 rounded js-scroll-trigger"
                href="#compare"
                >Compare</a
              >
            </li>
            <li class="nav-item mx-0 mx-lg-1">
              <a
                class="nav-link py-3 px-0 px-lg-3 rounded js-scroll-trigger"
                href="#about"
                >About</a
              >
            </li>
            <li class="nav-item mx-0 mx-lg-1">
              <a
                class="nav-link py-3 px-0 px-lg-3 rounded js-scroll-trigger"
                href="#contact"
                >Contact us</a
              >
            </li>
            <li class="nav-item mx-0 mx-lg-1 dropdown">
                <a class="nav-link py-3 px-0 px-lg-3 rounded js-scroll-trigger dropdown-toggle" data-toggle="dropdown" href="#" role="button" aria-haspopup="true" aria-expanded="false"> Event
                </a>
                <div class="dropdown-menu" x-placement="bottom-start" style="position: absolute; will-change: transform; top: 0px; left: 0px; transform: translate3d(15px, 37px, 0px);">
                    <a class="dropdown-item" href="pages/event/committees.html"><b>Committees</b></a>
                    <a class="dropdown-item" href="pages/event/keynotes.html">Keynotes</a>
                    <a class="dropdown-item" href="pages/event/tutorials.html">Tutorials</a>
                    <a class="dropdown-item" href="pages/event/Awards.html">Awards</a>
                </div>
            </li>
          </ul>
        </div>
      </div>
    </nav>

    <!-- Header -->
    <header class="masthead bg-primary text-white text-center">
      <div class="container">
        <h1 class="text-uppercase mb-0">Phone Comparator</h1>
        <hr class="star-light" />
        <img
          class="img-fluid mb-5 d-block mx-auto"
          src="img/compareSmartPhone.png"
          alt="find, compare and buy the best and cheap phone"
        />
      </div>
    </header>

    <!-- Compare Grid Section -->
    <section class="compare" id="compare">
      <div class="container">
        <h2 class="text-center text-uppercase text-secondary mb-0">Compare</h2>
        <hr class="star-dark mb-5" />
        <div class="row">
          <!-- First Phone -->
          <div class="col-md-4">
            <div class="form-group">
              <div class="card text-center">
                <div class="card-body">
                  <h5 class="card-title">Phone 1</h5>
                </div>
                <img
                  class="card-img-bottom mx-auto d-block imgDevice"
                  src="img/device.png"
                  alt="Phone one comparison"
                  style="width: 150px;height: 200px"
                />
              </div>
              <label>Select the Brand:</label>
              <select class="form-control brand" id="brandOne">
                <option value="" selected="selected">--Brand-- </option>
                {{#each brands}}
                  <option value="{{this.url}}">{{this.name}}</option>
                {{/each}}
              </select>
              <label>Select the Device:</label>
              <select class="form-control device" id="deviceOne">
                <option value="" selected="selected">--Device--</option>
              </select>
            </div>
          </div>
          <!-- Second Phone -->
          <div class="col-md-4">
            <div class="form-group">
              <div class="card text-center">
                <div class="card-body">
                  <h5 class="card-title">Phone 2</h5>
                </div>
                <img
                  class="card-img-bottom mx-auto d-block imgDevice"
                  src="img/device.png"
                  alt="Phone two comparison"
                  style="width: 150px;height: 200px"
                />
              </div>
              <label>Select the Brand:</label>
              <select class="form-control brand" id="brandTwo">
                <option value="" selected="selected">--Brand--</option>
                {{#each brands}}
                  <option value="{{this.url}}">{{this.name}}</option>
                {{/each}}
              </select>
              <label>Select the Device:</label>
              <select class="form-control device" id="deviceTwo">
                <option value="" selected="selected">--Device--</option>
              </select>
            </div>
          </div>
          <!-- Third Phone -->
          <div class="col-md-4">
            <div class="form-group">
              <div class="card text-center">
                <div class="card-body">
                  <h5 class="card-title">Phone 3</h5>
                </div>
                <img
                  class="card-img-bottom mx-auto d-block imgDevice"
                  src="img/device.png"
                  alt="Phone tree comparison"
                  style="width: 150px;height: 200px"
                />
              </div>
              <label>Select the Brand:</label>
              <select class="form-control brand" id="brandTree">
                <option value="" selected="selected">--Brand--</option>
                {{#each brands}}
                  <option value="{{this.url}}">{{this.name}}</option>
                {{/each}}
              </select>
              <label>Select the Device:</label>
              <select class="form-control device" id="deviceTree">
                <option value="" selected="selected">--Device--</option>
              </select>
            </div>
          </div>
        </div>

        <button
          type="submit"
          class="btn btn-primary btn-lg btn-block"
          id="CompareButton"
        >
          Compare
        </button>
      </div>
    </section>

    <!-- About Section -->
    <section class="bg-primary text-white mb-0" id="about">
      <div class="container">
        <h2 class="text-center text-uppercase text-white">About</h2>
        <hr class="star-light mb-5" />
        <div class="row">
          <div class="col-lg-12">
            <p class="lead text-justify">
              Phone Comparator gives you the ability to quickly and easily find
              the phone you want through our device comparator and buy it from
              the most popular e-commerce sites ( Amazon, AliExpress, ... ).
            </p>
          </div>
        </div>
      </div>
    </section>

    <!-- Blog Section -->
    <section class="bg-primary text-white mb-0" id="blog">
        <h2 class="text-center text-uppercase text-white">Blog</h2>
        <hr class="star-light mb-5" />
        <div class="row">
          <div class="col-lg-12">
            <p class="lead text-justify">
              Phone Comparator gives you the ability to quickly and easily find
              the phone you want through our device comparator and buy it from
              the most popular e-commerce sites ( Amazon, AliExpress, ... ).
            </p>
          </div>
        </div>
      </div>
    </section>

    <!-- Contact Section -->
    <section id="contact">
      <div class="container">
        <h2 class="text-center text-uppercase text-secondary mb-0">
          Contact Us
        </h2>
        <hr class="star-dark mb-5" />
        <div class="row">
          <div class="col-lg-8 mx-auto">
            <form name="sentMessage" id="contactForm" novalidate="novalidate">
              <div class="control-group">
                <div
                  class="form-group floating-label-form-group controls mb-0 pb-2"
                >
                  <label>Name</label>
                  <input
                    class="form-control"
                    id="name"
                    type="text"
                    placeholder="Name"
                    required="required"
                    data-validation-required-message="Please enter your name."
                  />
                  <p class="help-block text-danger"></p>
                </div>
              </div>
              <div class="control-group">
                <div
                  class="form-group floating-label-form-group controls mb-0 pb-2"
                >
                  <label>Email Address</label>
                  <input
                    class="form-control"
                    id="email"
                    type="email"
                    placeholder="Email Address"
                    required="required"
                    data-validation-required-message="Please enter your email address."
                  />
                  <p class="help-block text-danger"></p>
                </div>
              </div>
              <div class="control-group">
                <div
                  class="form-group floating-label-form-group controls mb-0 pb-2"
                >
                  <label>Phone Number</label>
                  <input
                    class="form-control"
                    id="phone"
                    type="tel"
                    placeholder="Phone Number"
                    data-validation-required-message="Please enter your phone number."
                  />
                  <p class="help-block text-danger"></p>
                </div>
              </div>
              <div class="control-group">
                <div
                  class="form-group floating-label-form-group controls mb-0 pb-2"
                >
                  <label>Message</label>
                  <textarea
                    class="form-control"
                    id="message"
                    rows="5"
                    placeholder="Message"
                    required="required"
                    data-validation-required-message="Please enter a message."
                  ></textarea>
                  <p class="help-block text-danger"></p>
                </div>
              </div>
              <br />
              <div id="success"></div>
              <div class="form-group">
                <button
                  type="submit"
                  class="btn btn-primary btn-xl"
                  id="sendMessageButton"
                >
                  Send
                </button>
              </div>
            </form>
          </div>
        </div>
      </div>
    </section>

    <!-- The Modal -->
    <div class="modal" id="infoModal">
      <div class="modal-dialog">
        <div class="modal-content">
          <!-- Modal Header -->
          <div class="modal-header">
            <h4 class="modal-title">Information</h4>
            <button type="button" class="close closeModal" data-dismiss="modal">
              &times;
            </button>
          </div>

          <!-- Modal body -->
          <div class="modal-body"></div>

          <!-- Modal footer -->
          <div class="modal-footer">
            <button
              type="button"
              class="btn btn-primary btn-xl closeModal"
              data-dismiss="modal"
            >
              Close
            </button>
          </div>
        </div>
      </div>
    </div>

    <!-- Scroll to Top Button (Only visible on small and extra-small screen sizes) -->
    <div class="scroll-to-top d-lg-none position-fixed ">
      <a
        class="js-scroll-trigger d-block text-center text-white rounded"
        href="#page-top"
      >
        <i class="fa fa-chevron-up"></i>
      </a>
    </div>
    <!-- Bootstrap core JavaScript -->
    <script src="vendor/jquery/jquery.min.js"></script>
    <script src="vendor/bootstrap/js/bootstrap.bundle.min.js"></script>

    <!-- Plugin JavaScript -->
    <script src="vendor/jquery-easing/jquery.easing.min.js"></script>
    <script src="vendor/magnific-popup/jquery.magnific-popup.min.js"></script>

    <!-- Contact Form JavaScript -->
    <script src="js/jqBootstrapValidation.js"></script>
    <script src="js/contact_me.js"></script>

    <!-- Custom scripts for this template -->
    <script src="js/phonecomparator.min.js"></script>

    <!-- Tools function -->
    <script src="js/tools.js"></script>

    <!-- Main script -->
    <script>
      function init(config) {
        $("select.device").attr("disabled", "true");
        // initBrands(config.api);
        handleDBrandOnChange(config.api);
        handleDeviceOnChange(config.api);
        handleCompareButton();
        $("#infoModal").click(function() {
          $("#infoModal").hide();
        });
      }

      function initBrands(api) {
        $.ajax({
          url: api + "/brands",
          timeout: 3000,
          success: function(brands) {
            brands.forEach(function(brand) {
              $("#brandOne").append(
                new Option(decodeEntities(brand.name), brand.url)
              );
              $("#brandTwo").append(
                new Option(decodeEntities(brand.name), brand.url)
              );
              $("#brandTree").append(
                new Option(decodeEntities(brand.name), brand.url)
              );
            });
            $("div.brandLoad").remove();
            $("select.brand").removeAttr("disabled");
          },
          error: function(e) {
            console.log('error', e);
            displayModal("Not connected.\nPlease verify \
                your network connection or retry your select..");
            $("div.brandLoad").remove();
          }
        });
      }

      function handleDBrandOnChange(api) {
        $(".brand").on("change", function(e) {
          var brandSelect = $(this);
          var devicesSelect = brandSelect.parent().find(".device");
          devicesSelect
            .find("option")
            .not(":first")
            .remove();
          devicesSelect.attr("disabled", "true");
          devicesSelect.trigger("change");
          if (brandSelect.val() == "") {
            return;
          }
          var devicesLabel = brandSelect.parent().find("label").first();
          var deviceLoad = $(
            '<div class="spinner-border spinner-border-sm deviceLoad" role="status">' +
              '<span class="sr-only">Loading...</span></div>'
          ).insertAfter(devicesLabel);
          $.ajax({
            url: api + "/phone?brand=" + brandSelect.val(),
            timeout: 5000,
            success: function(devices) {
              console.log('devices', devices);
              devices.forEach(function(device) {
                console.log('hello devices');
                devicesSelect.append(
                  new Option(decodeEntities(device.name), device.url)
                );
              });
              deviceLoad.remove();
              devicesSelect.removeAttr("disabled");
            },
            error: function(e) {
              if (e.responseText !== undefined && e.responseText.includes("page not found")) {
                displayModal("Could not find devices of <u> \ " +
                      brandSelect.find("option:selected").text() +
                      "</u> brand");
              } else {
                displayModal("Not connected.\nPlease verify \
                your network connection or retry your select...");
              }
              deviceLoad.remove();
              brandSelect.val("");
            }
          });
        });
      }

      function handleDeviceOnChange(api) {
        $(".device").on("change", function(e) {
          var deviceSelect = $(this);
          var deviceImg = deviceSelect
            .closest(".form-group")
            .find(".imgDevice")
            .first();
          if ($(this).val() == "") {
            if (!deviceImg.attr("src").includes("img/device.png")) {
              deviceImg.attr("src", "img/device.png");
            }
            return;
          }
          deviceImg.attr("src", "img/loadingDevice.gif");
          $.ajax({
            url: api + "/phone/" + $(this).val(),
            timeout: 5000,
            success: function(device) {
              if (device.img) {
                deviceImg.attr("src", device.img);
              } else {
                deviceImg.attr("src", "img/device.png");
              }
            },
            error: function(error) {
              console.log('error', e);
              if(error.status === 404) {
                displayModal("Not found.\n This device doesn't exist in our database \
                Please choose another ...");
              }
              else {
                displayModal("Not connected.\nPlease verify \
                your network connection or retry your select...");
              }
              deviceImg.attr("src", "img/device.png");
              deviceSelect.val("");
              return;
            }
          });
        });
      }

      function handleCompareButton() {
        $("#CompareButton").click(function() {
          const devices = $(".device").map(function(_, device) {
            return $(device).val();
          }).get().filter(Boolean);
          if(devices.length < 2) {
            displayModal("Please select at least two Devices ...");
          }
          else {
            let paramsStr = "";
            for (let [index, device] of devices.entries()) {
                paramsStr += "phone" + (index+1) + "=" + devices[index] + (index !== devices.length-1 ? "&" : "");
            }
            window.location.href =  "compare?" + paramsStr.replace(/.php/g, '');
          }
        });
      }

      $.get('./config/prod.json', function(config) {
        init(config);
      });
    </script>
