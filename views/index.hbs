
    <!-- Navigation -->
    <nav
      class="navbar navbar-expand-lg bg-secondary fixed-top text-uppercase"
      id="mainNav"
    >
      <div class="container">
        <a class="navbar-brand js-scroll-trigger" href="#page-top"
          ><img src="/img/logo.png" width="210" height="75" alt="phone Comparator"
        /></a>
        <button
          class="navbar-toggler navbar-toggler-right text-uppercase bg-primary text-white rounded"
          type="button"
          data-toggle="collapse"
          data-target="#navbarResponsive"
          aria-controls="navbarResponsive"
          aria-expanded="false"
          aria-label="Toggle navigation"
        >
          Menu
          <i class="fas fa-bars"></i>
        </button>
        <div class="collapse navbar-collapse" id="navbarResponsive">
          <ul class="navbar-nav ml-auto">
            <li class="nav-item mx-0 mx-lg-1">
              <a
                class="nav-link py-3 px-0 px-lg-3 rounded js-scroll-trigger"
                href="#compare"
                >Compare</a
              >
            </li>
            <li class="nav-item mx-0 mx-lg-1">
              <a
                class="nav-link py-3 px-0 px-lg-3 rounded js-scroll-trigger"
                href="#PopularMobileComparison"
                >Popular Comparison</a
              >
            </li>
            <li class="nav-item mx-0 mx-lg-1">
              <a
                class="nav-link py-3 px-0 px-lg-3 rounded js-scroll-trigger"
                href="#contact"
                >Contact us</a
              >
            </li>
          </ul>
        </div>
      </div>
    </nav>

    <!-- Header -->
    <header class="masthead bg-primary text-white text-center">
      <div class="container">
        <h1 class="text-uppercase mb-0">Phone Comparator</h1>
        <hr class="star-light" />
        <img
          class="img-fluid mb-5 d-block mx-auto"
          src="img/compareSmartPhone.png"
          alt="find, compare and buy the best and cheap phone"
        />
      </div>
    </header>

    <!-- Compare Grid Section -->
    <section class="compare" id="compare">
      <div class="container">
        <h2 class="text-center text-uppercase text-secondary mb-0">Compare</h2>
        <hr class="star-dark mb-5" />
        <div class="row">
          <!-- First Phone -->
          <div class="col-md-4">
            <div class="form-group">
              <div class="card text-center">
                <div class="card-body">
                  <h5 class="card-title">Phone 1</h5>
                </div>
                <img
                  class="card-img-bottom mx-auto d-block imgDevice"
                  src="img/device.png"
                  alt="Phone one comparison"
                />
              </div>
              <label>Select the Brand:</label>
              <select class="form-control selectpicker brand" id="brandOne">
                <option value="" selected="selected">--Brand-- </option>
                {{#each brands}}
                  <option value="{{this.id}}">{{this.data.name}}</option>
                {{/each}}
              </select>
              <label>Select the Device:</label>
              <select class="form-control selectpicker device" id="deviceOne">
                <option value="" selected="selected">--Device--</option>
              </select>
            </div>
          </div>
          <!-- Second Phone -->
          <div class="col-md-4">
            <div class="form-group">
              <div class="card text-center">
                <div class="card-body">
                  <h5 class="card-title">Phone 2</h5>
                </div>
                <img
                  class="card-img-bottom mx-auto d-block imgDevice"
                  src="img/device.png"
                  alt="Phone two comparison"
                />
              </div>
              <label>Select the Brand:</label>
              <select class="form-control selectpicker brand" id="brandTwo">
                <option value="" selected="selected">--Brand--</option>
                {{#each brands}}
                  <option value="{{this.id}}">{{this.data.name}}</option>
                {{/each}}
              </select>
              <label>Select the Device:</label>
              <select class="form-control selectpicker device" id="deviceTwo">
                <option value="" selected="selected">--Device--</option>
              </select>
            </div>
          </div>
          <!-- Third Phone -->
          <div class="col-md-4">
            <div class="form-group">
              <div class="card text-center">
                <div class="card-body">
                  <h5 class="card-title">Phone 3</h5>
                </div>
                <img
                  class="card-img-bottom mx-auto d-block imgDevice"
                  src="img/device.png"
                  alt="Phone tree comparison"
                />
              </div>
              <label>Select the Brand:</label>
              <select class="form-control selectpicker brand" id="brandTree">
                <option value="" selected="selected">--Brand--</option>
                {{#each brands}}
                  <option value="{{this.id}}">{{this.data.name}}</option>
                {{/each}}
              </select>
              <label>Select the Device:</label>
              <select class="form-control selectpicker device" id="deviceTree">
                <option value="" selected="selected">--Device--</option>
              </select>
            </div>
          </div>
        </div>

        <button
          type="submit"
          class="btn btn-primary btn-lg btn-block"
          id="CompareButton"
        >
          Compare
        </button>
      </div>
    </section>

    <!-- Popular Mobile Comparison Section -->
    <section class="bg-primary text-white mb-0" id="PopularMobileComparison">
      <div class="container">
        <h2 class="text-center text-uppercase text-white">Popular Comparison</h2>
        <hr class="star-light mb-5" />
        <div class="row">
          <div class="col-lg-12">
            <div class="list-group">
              <div class="list-group-item popularMobileComparison">
                <i class="fa fa-search" aria-hidden="true"></i>&nbsp;
                <a href="/compare/apple%5fiphone%5f11-9848-vs-apple%5fiphone%5f11%5fpro-9847">
                  Iphone 11 VS Iphone 11 Pro
                </a>
              </div>
              <div class="list-group-item popularMobileComparison">
                <i class="fa fa-search" aria-hidden="true"></i>&nbsp;
                <a href="/compare/samsung%5galaxy%5s10-9536-vs-apple%5iphone%511-9848">
                  Samsung Galaxy s10 VS Iphone 11
                </a>
              </div>
              <div class="list-group-item popularMobileComparison">
                <i class="fa fa-search" aria-hidden="true"></i>&nbsp;
                <a href="/compare/oneplus%57-9623-vs-huawei%5p30-9530">
                  OnePlus 7 VS Huawei P30
                </a>
              </div>
              <div class="list-group-item popularMobileComparison">
                <i class="fa fa-search" aria-hidden="true"></i>&nbsp;
                <a href="/compare/apple%5iphone%511-9848-vs-apple%5iphone%5xr-9320">
                  iPhone 11 VS Apple iPhone XR
                </a>
              </div>
              <div class="list-group-item popularMobileComparison">
                <i class="fa fa-search" aria-hidden="true"></i>&nbsp;
                <a href="/compare/samsung_galaxy_note10-9788-vs-samsung_galaxy_note10+-9732">
                  Samsung Galaxy Note 10 VS Samsung Galaxy Note 10+
                </a>
              </div>
              <div class="list-group-item popularMobileComparison">
                <i class="fa fa-search" aria-hidden="true"></i>&nbsp;
                <a href="/compare/google_pixel_3-9256-vs-google_pixel_3_xl-9257">
                  Google Pixel 3 VS Google Pixel 3 XL
                </a>
              </div>
              <div class="list-group-item popularMobileComparison">
                <i class="fa fa-search" aria-hidden="true"></i>&nbsp;
                <a href="/compare/xiaomi_redmi_k20_pro-9708-vs-xiaomi_redmi_note_8t-9946">
                  Xiaomi Redmi K20 Pro VS Xiaomi Note 8
                </a>
              </div>
            </div>
          </div>
        </div>
        </div>
    </section>

    <!-- Contact Section -->
    <section id="contact">
      <div class="container">
        <h2 class="text-center text-uppercase text-secondary mb-0">
          Contact Us
        </h2>
        <hr class="star-dark mb-5" />
        <div class="row">
          <div class="col-lg-8 mx-auto">
            <form name="sentMessage" id="contactForm" novalidate="novalidate">
              <div class="control-group">
                <div
                  class="form-group floating-label-form-group controls mb-0 pb-2"
                >
                  <label>Name</label>
                  <input
                    class="form-control"
                    id="name"
                    type="text"
                    placeholder="Name"
                    required="required"
                    data-validation-required-message="Please enter your name."
                  />
                  <p class="help-block text-danger"></p>
                </div>
              </div>
              <div class="control-group">
                <div
                  class="form-group floating-label-form-group controls mb-0 pb-2"
                >
                  <label>Email Address</label>
                  <input
                    class="form-control"
                    id="email"
                    type="email"
                    placeholder="Email Address"
                    required="required"
                    data-validation-required-message="Please enter your email address."
                  />
                  <p class="help-block text-danger"></p>
                </div>
              </div>
              <div class="control-group">
                <div
                  class="form-group floating-label-form-group controls mb-0 pb-2"
                >
                  <label>Phone Number</label>
                  <input
                    class="form-control"
                    id="phone"
                    type="tel"
                    placeholder="Phone Number"
                    data-validation-required-message="Please enter your phone number."
                  />
                  <p class="help-block text-danger"></p>
                </div>
              </div>
              <div class="control-group">
                <div
                  class="form-group floating-label-form-group controls mb-0 pb-2"
                >
                  <label>Message</label>
                  <textarea
                    class="form-control"
                    id="message"
                    rows="5"
                    placeholder="Message"
                    required="required"
                    data-validation-required-message="Please enter a message."
                  ></textarea>
                  <p class="help-block text-danger"></p>
                </div>
              </div>
              <br />
              <div id="success"></div>
              <div class="form-group">
                <button
                  type="submit"
                  class="btn btn-primary btn-xl"
                  id="sendMessageButton"
                >
                  Send
                </button>
              </div>
            </form>
          </div>
        </div>
      </div>
    </section>

    <!-- The Modal -->
    <div class="modal" id="infoModal">
      <div class="modal-dialog">
        <div class="modal-content">
          <!-- Modal Header -->
          <div class="modal-header">
            <h4 class="modal-title">Information</h4>
            <button type="button" class="close closeModal" data-dismiss="modal">
              &times;
            </button>
          </div>

          <!-- Modal body -->
          <div class="modal-body"></div>

          <!-- Modal footer -->
          <div class="modal-footer">
            <button
              type="button"
              class="btn btn-primary btn-xl closeModal"
              data-dismiss="modal"
            >
              Close
            </button>
          </div>
        </div>
      </div>
    </div>

    <!-- Scroll to Top Button (Only visible on small and extra-small screen sizes) -->
    <div class="scroll-to-top d-lg-none position-fixed ">
      <a
        class="js-scroll-trigger d-block text-center text-white rounded"
        href="#page-top"
      >
        <i class="fa fa-chevron-up"></i>
      </a>
    </div>
    <!-- Bootstrap core JavaScript -->
    <script src="js/jquery/jquery.min.js"></script>
    <script src="js/bootstrap/bootstrap.bundle.min.js"></script>
    <!-- Bootstrap select JavaScript -->
    <script src="js/bootstrap/bootstrap-select.min.js"></script>

    <!-- Plugin JavaScript -->
    <script src="js/jquery-easing/jquery.easing.min.js"></script>
    <script src="js/magnific-popup/jquery.magnific-popup.min.js"></script>

    <!-- Contact Form JavaScript -->
    <script src="js/jqBootstrapValidation.js"></script>
    <script src="js/contact_me.js"></script>

    <!-- Custom scripts for this template -->
    <script src="js/phonecomparator.min.js"></script>

    <!-- Tools function -->
    <script src="js/tools.js"></script>

    <!-- Main script -->
    <script>
      function init() {
        $("select.device").attr("disabled", "true");
        $(".selectpicker").val('').selectpicker('refresh');
        handleDBrandOnChange();
        handleDeviceOnChange();
        handleCompareButton();
        $("#infoModal").click(function() {
          $("#infoModal").hide();
        });
      }

      function handleDBrandOnChange() {
        $(".brand").on("change", function(e) {
          var brandSelect = $(this);
          var devicesSelect = brandSelect.parent().parent().find(".selectpicker.device");
           var deviceImg = devicesSelect
            .closest(".form-group")
            .find(".imgDevice")
            .first();
          deviceImg.attr("src", "img/device.png");
          devicesSelect
            .find("option")
            .not(":first")
            .remove();
          devicesSelect.attr("disabled", "true");
          devicesSelect.trigger("change");
          if (brandSelect.val() == "") {
            return;
          }
          var devicesLabel = brandSelect.parent().parent().find("label").first();
          var deviceLoad = $(
            '<div class="spinner-border spinner-border-sm deviceLoad" role="status">' +
              '<span class="sr-only">Loading...</span></div>'
          ).insertAfter(devicesLabel);
          $.ajax({
            url: "/phone?brand=" + brandSelect.val(),
            timeout: 5000,
            success: function(devices) {
              var options = ["<option value='' selected='selected'>--Device--</option>"];
              devices.forEach(function(device) {
                  options.push("<option value='" + device.url + "'>" + device.name + "</option>");
              });
              devicesSelect.html(options).removeAttr("disabled");
              devicesSelect.selectpicker('refresh');
              deviceLoad.remove();
            },
            error: function(e) {
              if (e.responseText !== undefined && e.responseText.includes("page not found")) {
                displayModal("Could not find devices of <u> \ " +
                      brandSelect.find("option:selected").text() +
                      "</u> brand");
              } else {
                displayModal("Not connected.\nPlease verify \
                your network connection or retry your select...");
              }
              deviceLoad.remove();
              brandSelect.val("");
            }
          });
        });
      }

      function handleDeviceOnChange() {
        $(".device").on("change", function(e) {
          var deviceSelect = $(this);
          var deviceImg = deviceSelect
            .closest(".form-group")
            .find(".imgDevice")
            .first();
          if ($(this).val() == "") {
            return;
          }
          deviceImg.attr("src", "img/loadingDevice.gif");
          $.ajax({
            url: "/phone/" + $(this).val(),
            timeout: 5000,
            success: function(device) {
              if (device.img) {
                deviceImg.attr("src", device.img);
              } else {
                deviceImg.attr("src", "img/device.png");
              }
            },
            error: function(error) {
              console.log('error', e);
              if(error.status === 404) {
                displayModal("Not found.\n This device doesn't exist in our database \
                Please choose another ...");
              }
              else {
                displayModal("Not connected.\nPlease verify \
                your network connection or retry your select...");
              }
              deviceImg.attr("src", "img/device.png");
              deviceSelect.val("");
              return;
            }
          });
        });
      }

      function handleCompareButton() {
        $("#CompareButton").click(function() {
          const devices = $(".device").map(function(_, device) {
            return $(device).val();
          }).get().filter(Boolean);
          if(devices.length < 2) {
            displayModal("Please select at least two Devices ...");
          }
          else {
            let paramsStr = "";
            for (let [index, device] of devices.entries()) {
                paramsStr += devices[index] + (index !== devices.length-1 ? "-vs-" : "");
            }
            window.location.href =  "compare/" + paramsStr.replace(/.php/g, '');
          }
        });
      }
      init();
    </script>
